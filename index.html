<!DOCTYPE html>
<html lang="zh-Hans">
  <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="只能自己努力找乐子了">
    <meta name="keywords" content>
    <meta name="author">
    <meta name="copyright">
    <title>_(:з」∠)_ | luckyray</title><link rel="shortcut icon" href="/favicons.ico">
    <link rel="stylesheet" href="/css/index.css?version=1.6.1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1">
    <link rel="dns-prefetch" href="https://cdn.staticfile.org">
    <link rel="dns-prefetch" href="https://cdn.bootcss.com">
    <link rel="dns-prefetch" href="https://creativecommons.org">
    <script>
      var GLOBAL_CONFIG = {
        root: '/',
        algolia: undefined,
        localSearch: undefined,
        copy: {
          success: '复制成功',
          error: '复制错误',
          noSupport: '浏览器不支持'
        }
      }
    </script>
  </head>
  <body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i>
    <div id="sidebar">
      <div class="author-info">
        <div class="author-info__avatar text-center"><img src="/img/avatar.png"></div>
        <div class="author-info__name text-center"></div>
        <div class="author-info__description text-center">只能自己努力找乐子了</div>
        <hr>
        <div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">7</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">4</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">3</span></a>
        </div>
      </div>
    </div>
    <nav id="nav" style="background-image: url(http://img.luckyray.cn/896653.jpg)">
      <div id="page-header"><span class="pull-left"> <a id="site-name" href="/">luckyray</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div>
      <div id="site-info">
        <div id="site-title">luckyray</div>
        <div id="site-sub-title">_(:з」∠)_</div>
        <div id="site-social-icons"><a class="social-icon" href="https://github.com/yoshiro_fan"><i class="fa-github fa"></i></a>
        </div>
      </div>
    </nav>
    <div id="content-outer">
      <div class="layout" id="content-inner">
        <div class="recent-post-item article-container"><a class="article-title" href="/2019/10/20/promise-await-yield/">promise-await-yield 异步三连</a>
          <time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-10-20
          </time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/进阶/">进阶</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Javascript/">Javascript</a></span>
          <div class="content"><p>JavaScript 中使用异步的情况非常多, 因为 js 采取单线程, 如果某段代码处理时间过长, 后面的代码将一直等待其执行完毕。<br>由此产生的处理方案是, 任务队列与事件循环(event loop), 无论是最初的回调函数(并非异步专属), 还是后面解决 callback hell 而出现的 promise 等, 都是依靠在这个机制上的。</p>
<blockquote>
<p>主线程遇到异步函数时, 将其扔给异步模块, 继续执行主线程中剩下的部分, 当异步函数满足了执行要求时, 将回调函数放入任务队列中, 主线程完成后, 才会从任务队列中选择任务执行, 而 event loop 负责的是不断从任务队列中取代码, 详细请看-<a href="https://segmentfault.com/a/1190000011198232" target="_blank" rel="noopener">JavaScript 异步、栈、事件循环、任务队列</a></p>
</blockquote>
<h3 id="历史演变情况"><a href="#历史演变情况" class="headerlink" title="历史演变情况"></a>历史演变情况</h3><p>易嵌套的 callback <code>-&gt;</code> promise <code>-&gt;</code> promise 包装的 generator <code>-&gt;</code> generator 的语法糖 await</p>
<h4 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h4><p>下方新构建一个 promise 的对象, 传入的是一个回调函数, 回调函数在执行时会被传入两个参数, resolve 与 reject, 这个resolve 其实就是在 then 函数中传入的回调</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        resolve(<span class="number">123</span>);</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;);</span><br><span class="line">p.then(<span class="function">(<span class="params">data</span>)=&gt;</span><span class="built_in">console</span>.log(data))</span><br></pre></td></tr></table></figure>

</div>
          <hr>
        </div>
        <div class="recent-post-item article-container"><a class="article-title" href="/2019/10/11/software-development-mode/">软件开发 设计模式</a>
          <time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-10-11
          </time>
          <div class="content"><h3 id="纲要"><a href="#纲要" class="headerlink" title="纲要"></a>纲要</h3><ol>
<li>部分设计模式是为了弥补静态类型中难以实现某些代码(功能复用)而存在的</li>
<li>动态类型语言很大部分不需要</li>
<li>设计模式是将达成软件复用等需求的惯用法抽象而成的</li>
<li>有总结设计模式的套路</li>
</ol>
<p>那么, 为什么动态类型会不需要这些设计模式:</p>
<h3 id="收集总结"><a href="#收集总结" class="headerlink" title="收集总结"></a>收集总结</h3><h4 id="包装"><a href="#包装" class="headerlink" title="包装"></a>包装</h4><p>将某个核心方法进行包装, 实现多个功能</p>
</div>
          <hr>
        </div>
        <div class="recent-post-item article-container"><a class="article-title" href="/2019/10/08/jquery-study-plugin/">jquery 学习思考-扩展</a>
          <time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-10-08
          </time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/框架源码/">框架源码</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/javascript/">javascript</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/jquery/">jquery</a></span>
          <div class="content"><p>需求, 能够选中日期然后返回字段。另外, 设计页面时遵循:</p>
<ol>
<li>基础事件所需要的界面</li>
<li>自己作为用户确认是否继续添加交互</li>
<li>根据 2 回到 1 或结束<h3 id="date-picker-来源"><a href="#date-picker-来源" class="headerlink" title="date picker 来源"></a>date picker 来源</h3>来源是<a href="https://www.jqueryscript.net/demo/Pretty-Event-Calendar-&-Datepicker-Plugin-For-jQuery-Calendar-js/" target="_blank" rel="noopener">这个网站</a></li>
</ol>
<h3 id="界面构建阶段"><a href="#界面构建阶段" class="headerlink" title="界面构建阶段"></a>界面构建阶段</h3><p>首先先写好界面, 然后保证结构不变添加事件, 再依次完善事件界面<br>完成界面, 完完整整根据设计图来就行</p>
<blockquote>
<p>为了省事大部分css与原网址一致, 注意此阶段写死了参数, 后面js动态生成时会更改</p>
</blockquote>
<h4 id="input-输入框"><a href="#input-输入框" class="headerlink" title="input 输入框"></a>input 输入框</h4><p>用最常见的样式, 这是在<a href="https://codepen.io/andreasstorm/pen/gKGbxo" target="_blank" rel="noopener">网上找到的</a>, 其动态效果的触发为 :placeholder-shown, hover, focus ,属性为 transform 中的 translate, scale, transform-origin。控制为 transition<br>触发含义: placeholder(占位符)是否展示。<br>属性含义: 移动, 缩放, 动画效果起始点。<br><img src="/image/jQuery-5.png" alt="input输入框"></p>
<blockquote>
<p>原网址用的 <a href="http://stylus-lang.com/" target="_blank" rel="noopener">stylus</a> css预处理器, 可以通过css框的右上角的箭头 选择 view compiled css 看处理后的 css</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">      #inp &#123;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">        width: 100%;</span><br><span class="line">        border: 0;</span><br><span class="line">        padding: 12px 0;</span><br><span class="line">        height: 48px;</span><br><span class="line">        font-size: 18px;</span><br><span class="line">        font-weight: 500;</span><br><span class="line">        border-bottom: 2px solid #c8ccd4;</span><br><span class="line">        border-radius: 0;</span><br><span class="line">        color: #223254;</span><br><span class="line">        transition: all 0.15s ease;</span><br><span class="line">      &#125;</span><br><span class="line">      #inp:hover &#123;</span><br><span class="line">        background: rgba(34, 50, 84, 0.03);</span><br><span class="line">      &#125;</span><br><span class="line">      #inp:not(:placeholder-shown) + span &#123;</span><br><span class="line">        color: #5a667f;</span><br><span class="line">        transform: translateY(-26px) scale(0.75);</span><br><span class="line">      &#125;</span><br><span class="line">      #inp:focus &#123;</span><br><span class="line">        background: none;</span><br><span class="line">        outline: none;</span><br><span class="line">      &#125;</span><br><span class="line">      #inp:focus + span &#123;</span><br><span class="line">        color: #07f;</span><br><span class="line">        transform: translateY(-26px) scale(0.75);</span><br><span class="line">      &#125;</span><br><span class="line">      #inp:focus + span + .border &#123;</span><br><span class="line">        transform: scaleX(1);</span><br><span class="line">      &#125;</span><br><span class="line">      .inp &#123;</span><br><span class="line">        position: relative;</span><br><span class="line">        top: 50px;</span><br><span class="line">        margin: auto;</span><br><span class="line">        width: 100%;</span><br><span class="line">        max-width: 280px;</span><br><span class="line">        display: block;</span><br><span class="line">      &#125;</span><br><span class="line">      .inp * &#123;</span><br><span class="line">        box-sizing: border-box;</span><br><span class="line">      &#125;</span><br><span class="line">      .label &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        top: 16px;</span><br><span class="line">        left: 0;</span><br><span class="line">        font-size: 16px;</span><br><span class="line">        color: #9098a9;</span><br><span class="line">        font-weight: 500;</span><br><span class="line">        transform-origin: 0 0;</span><br><span class="line">        transition: all 0.2s ease;</span><br><span class="line">      &#125;</span><br><span class="line">      .border &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        bottom: 0;</span><br><span class="line">        left: 0;</span><br><span class="line">        height: 2px;</span><br><span class="line">        width: 100%;</span><br><span class="line">        background: #0077ff;</span><br><span class="line">        transform: scaleX(0);</span><br><span class="line">        transform-origin: 0 0;</span><br><span class="line">        transition: all 0.15s ease;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inp"</span> <span class="attr">class</span>=<span class="string">"inp"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"inp"</span> <span class="attr">placeholder</span>=<span class="string">"&amp;nbsp;"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span>Label<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"border"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="头部"><a href="#头部" class="headerlink" title="头部"></a>头部</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">布局用的float, 周围的空白用的 padding, text-indent控制。</span><br><span class="line">![](/image/jQuery-6.png)</span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">data</span>=<span class="string">"wrap背景阴影"</span>&gt;</span></span><br><span class="line">      .wrap &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        background: #fdfdfd;</span><br><span class="line">        border: 1px solid #e8e8e8;</span><br><span class="line">        box-shadow: 1px 2px 3px #ddd;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">data</span>=<span class="string">"hd年月份"</span>&gt;</span></span><br><span class="line">      .hd &#123;</span><br><span class="line">        padding: 10px 0;</span><br><span class="line">        height: 30px;</span><br><span class="line">        line-height: 30px;</span><br><span class="line">      &#125;</span><br><span class="line">      .date-year &#123;</span><br><span class="line">        font-size: 28px;</span><br><span class="line">        text-indent: 10px;</span><br><span class="line">        text-decoration: none;</span><br><span class="line">        float: left;</span><br><span class="line">      &#125;</span><br><span class="line">      .year &#123;</span><br><span class="line">        color: #ddd;</span><br><span class="line">      &#125;</span><br><span class="line">      .m &#123;</span><br><span class="line">        color: #888;</span><br><span class="line">        margin-left: -5px;</span><br><span class="line">      &#125;</span><br><span class="line">      .arrow &#123;</span><br><span class="line">        width: 50px;</span><br><span class="line">        margin-right: 10px;</span><br><span class="line">        float: right;</span><br><span class="line">        font: 500 26px sans-serif;</span><br><span class="line">        color: #ddd;</span><br><span class="line">      &#125;</span><br><span class="line">      .prev &#123;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">        float: left;</span><br><span class="line">      &#125;</span><br><span class="line">      .next &#123;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">        float: right;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrap"</span> <span class="attr">style</span>=<span class="string">"width: 280px;"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"date"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"hd"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:;"</span> <span class="attr">class</span>=<span class="string">"date-year"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"year"</span>&gt;</span>2019/<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"m"</span>&gt;</span>10<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"arrow"</span>&gt;</span></span><br><span class="line">              &lt;span class="prev"&gt;&lt;&lt;/span&gt;</span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"next"</span>&gt;</span>&gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ct"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"month"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="主体"><a href="#主体" class="headerlink" title="主体"></a>主体</h4><p>注意拥有float属性的元素的父元素需要加个宽度<br><img src="/image/jquery-7.png" alt="date picker 主体"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">data</span>=<span class="string">"ct主体"</span>&gt;</span></span><br><span class="line">      .week &#123;</span><br><span class="line">        color: #888;</span><br><span class="line">      &#125;</span><br><span class="line">      ul,</span><br><span class="line">      ol,</span><br><span class="line">      li &#123;</span><br><span class="line">        list-style: none;</span><br><span class="line">        padding: 0;</span><br><span class="line">        margin: 0;</span><br><span class="line">      &#125;</span><br><span class="line">      html &#123;</span><br><span class="line">        font: 500 14px 'roboto';</span><br><span class="line">        color: #333;</span><br><span class="line">      &#125;</span><br><span class="line">      .wrap li &#123;</span><br><span class="line">        position: relative;</span><br><span class="line">        float: left;</span><br><span class="line">        text-align: center;</span><br><span class="line">        border-radius: 50%;</span><br><span class="line">        width: 40px;</span><br><span class="line">        height: 40px;</span><br><span class="line">        line-height: 40px;</span><br><span class="line">      &#125;</span><br><span class="line">      .items &gt; li &#123;</span><br><span class="line">        width: 280px;</span><br><span class="line">      &#125;</span><br><span class="line">      .old &#123;</span><br><span class="line">        color: #888;</span><br><span class="line">      &#125;</span><br><span class="line">      .now &#123;</span><br><span class="line">        color: #fff;</span><br><span class="line">        background: #66be8c !important;</span><br><span class="line">      &#125;</span><br><span class="line">      .new &#123;</span><br><span class="line">        color: #888;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrap"</span> <span class="attr">style</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"date"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"hd"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:;"</span> <span class="attr">class</span>=<span class="string">"date-year"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"year"</span>&gt;</span>2019/<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"m"</span>&gt;</span>10<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"arrow"</span>&gt;</span></span><br><span class="line">              &lt;span class="prev"&gt;&lt;&lt;/span&gt;</span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"next"</span>&gt;</span>&gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ct"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ol</span> <span class="attr">class</span>=<span class="string">"week"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span>&gt;</span>Sun<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span>&gt;</span>Mon<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span>&gt;</span>Tue<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span>&gt;</span>Wed<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span>&gt;</span>Thu<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span>&gt;</span>Fri<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span>&gt;</span>Sat<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"items"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ol</span> <span class="attr">class</span>=<span class="string">"days"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"old"</span>&gt;</span>29<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"old"</span>&gt;</span>30<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>6<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>7<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>8<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>9<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>10<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>11<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>12<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>13<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">" now"</span>&gt;</span>14<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>15<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>16<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>17<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>18<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>19<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>20<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>21<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>22<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>23<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>24<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>25<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>26<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>27<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>28<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>29<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>30<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span>31<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"new"</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"new"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"new"</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"new"</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"new"</span>&gt;</span>5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"new"</span>&gt;</span>6<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"new"</span>&gt;</span>7<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"new"</span>&gt;</span>8<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"new"</span>&gt;</span>9<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"month"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="交互事件阶段"><a href="#交互事件阶段" class="headerlink" title="交互事件阶段"></a>交互事件阶段</h3><p>####</p>
<h3 id="插件改写阶段"><a href="#插件改写阶段" class="headerlink" title="插件改写阶段"></a>插件改写阶段</h3><h4 id="css-命名空间"><a href="#css-命名空间" class="headerlink" title="css 命名空间"></a>css 命名空间</h4><p>没有采用前缀限制, 好奇css module里的类名, 所以玩玩, 探索一下。一激灵, 写成了用webpack打包的样子, 虽然还是能将生成的main.js引入html来达到想要的效果, 但是这已经和jquery 没关系了, 所以还是回到正道上吧</p>
</div>
          <hr>
        </div>
        <div class="recent-post-item article-container"><a class="article-title" href="/2019/10/06/jquery-study/">jquery 学习思考</a>
          <time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-10-06
          </time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/框架源码/">框架源码</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/javascript/">javascript</a></span>
          <div class="content"><p>见识过不少东西, 也写过一些东西后。开始学习别人的写法, 从最佳实践, 代码组织, 到语言特性, 设计模式。</p>
<p>关于学习别人,</p>
<blockquote>
<ol>
<li>分析结构, 编写简易版本(构建骨架模拟操作, 剩下的只需要添加功能完善)</li>
<li>了解工作流, 扩展增强它</li>
</ol>
</blockquote>
<h3 id="基础结构"><a href="#基础结构" class="headerlink" title="基础结构"></a>基础结构</h3><blockquote>
<p>这部分引用的是 jQuery 在 <a href="https://github.com/jquery/jquery" target="_blank" rel="noopener">github</a> 上的仓库,使用的模块管理是 requirejs (与 nodejs 中的 require 不是一个规范) 下面的链接是大概位置, 顺序大概是打包后的。如果想搜索相关的代码, 可以利用 github 的仓库内寻找, 能查找文件内容, 很方便</p>
<ol>
<li><a href="https://github.com/jquery/jquery/blob/master/src/wrapper.js" target="_blank" rel="noopener">立即执行函数 , 构建jQuery同时兼容node环境</a></li>
<li><a href="https://github.com/jquery/jquery/tree/master/src/var" target="_blank" rel="noopener">全局通用变量与函数 , 方便使用</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/core/init.js" target="_blank" rel="noopener">init函数 , 原型链</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/core.js#L126" target="_blank" rel="noopener">extend , 为jQuery添加新函数</a></li>
<li><a href="https://github.com/jquery/sizzle" target="_blank" rel="noopener">sizzle 函数</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/callbacks.js#L40" target="_blank" rel="noopener">callbacks 函数</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/deferred.js" target="_blank" rel="noopener">Deferred promise</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/data.js" target="_blank" rel="noopener">Data 数据缓存</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/queue.js" target="_blank" rel="noopener">queue 队列操作: 执行顺序</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/attributes.js" target="_blank" rel="noopener">attr 元素属性操作</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/css.js" target="_blank" rel="noopener">CSS 操作</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/event.js#L816" target="_blank" rel="noopener">event 操作, on 与 off 函数</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/selector.js" target="_blank" rel="noopener">DOM&amp;CSS 操作</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/effects.js" target="_blank" rel="noopener">animation tween 函数</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/ajax.js#L386" target="_blank" rel="noopener">Ajax 操作</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/dimensions.js" target="_blank" rel="noopener">dimension 位置与尺寸</a></li>
<li><a href="https://github.com/jquery/jquery/blob/master/src/exports/global.js#L15" target="_blank" rel="noopener">noconflict 操作</a></li>
</ol>
</blockquote>
<p>然后简单介绍一下 requirejs 的 amd 规范, 这与前端模块化有关, 采用异步加载, <a href="http://www.ruanyifeng.com/blog/2012/11/require_js.html" target="_blank" rel="noopener">详细的看</a>(现在没见谁用过= =)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//主模块 main.js</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">'A'</span>,<span class="string">'jquery'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">a,$</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//code here</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//其他文件 定义依赖 jQuery 的模块</span></span><br><span class="line">define([<span class="string">'jquery'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> $</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//test.js 文件中 定义模块 test</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'test'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="实现细节"><a href="#实现细节" class="headerlink" title="实现细节"></a>实现细节</h3><h4 id="立即执行闭包"><a href="#立即执行闭包" class="headerlink" title="立即执行闭包"></a>立即执行闭包</h4><p>对外只返回出一个 jQuery 与 $ 对象, 不污染全局变量。闭包主要作用, 让函数执行完后的变量仍可被引用, 延长生命, 当然这里并不构成闭包, 下面模块与浏览器兼容里的才是(必须要返回函数或者setTimeOut等, 总结一下就是稍后在外部会执行)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">global,factory</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//some code</span></span><br><span class="line">  factory(global)</span><br><span class="line">&#125;)(<span class="built_in">window</span>,<span class="function"><span class="keyword">function</span>(<span class="params">window, noGlobal</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//也是 some code</span></span><br><span class="line">  <span class="keyword">if</span> (!noGlobal) &#123;</span><br><span class="line">    <span class="built_in">window</span>.jQuery = <span class="built_in">window</span>.$ = jQuery;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="import-与浏览器兼容"><a href="#import-与浏览器兼容" class="headerlink" title="import 与浏览器兼容"></a>import 与浏览器兼容</h4><p>根据传入的 global 与 module 判断环境, 再选择执行模式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">global,factory</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">module</span> === <span class="string">'object'</span>)&#123;</span><br><span class="line">    <span class="built_in">module</span>.exports = global.document</span><br><span class="line">      ? factory(global, <span class="literal">true</span>) <span class="comment">//就不会有  window.xxx 的绑定了, 而只是返回 jQuery</span></span><br><span class="line">      : <span class="function"><span class="keyword">function</span>(<span class="params">w</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">if</span> (!w.document) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'jQuery requires a window with a document'</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> factory(w);</span><br><span class="line">        &#125;;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    factory(global) <span class="comment">//没有 module 的话直接运行</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)(<span class="built_in">window</span>,<span class="function"><span class="keyword">function</span>(<span class="params">window, noGlobal</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//还是 some code</span></span><br><span class="line">  <span class="keyword">if</span> (!noGlobal) &#123;</span><br><span class="line">    <span class="built_in">window</span>.jQuery = <span class="built_in">window</span>.$ = jQuery;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> jQuery</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="jQuery-与-jQuery-fn"><a href="#jQuery-与-jQuery-fn" class="headerlink" title="jQuery 与 jQuery.fn"></a>jQuery 与 jQuery.fn</h4><p>jQuery.fn 的方法需要进行初始化, 而直接在jQuery上写定的方法则可以直接使用 <code>$.ajax</code> 来执行</p>
<p><img src="/image/jQuery-1.png" alt="jQuery上的方法"></p>
<p><img src="/image/jquery-2.png" alt="jQuery.fn上的方法"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jQuery.fn = jQuery.prototype = &#123;</span><br><span class="line">  <span class="comment">//some code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/image/jQuery-3.png" alt="jQuery原型链"></p>
<h4 id="无-new-返回对象"><a href="#无-new-返回对象" class="headerlink" title="无 new 返回对象"></a>无 new 返回对象</h4><p>没有使用 new 却构造出了新的对象, 通过原型链让 init 的对象能使用jQuery原型方法, 另外 jQuery 可以通过不同的 selector 创建对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">jQuery = <span class="function"><span class="keyword">function</span>(<span class="params">selector, context</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> jQuery.fn.init(selector, context);</span><br><span class="line">&#125;</span><br><span class="line">jQuery.fn = jQuery.prototype = &#123;&#125;</span><br><span class="line"><span class="comment">// some code</span></span><br><span class="line">init = (jQuery.fn.init = <span class="function"><span class="keyword">function</span>(<span class="params">selector,context,root</span>)</span>&#123;</span><br><span class="line">  context = context?context:<span class="built_in">window</span>.document</span><br><span class="line">  <span class="keyword">var</span> elem = context.querySelectorAll(slector)</span><br><span class="line">  <span class="keyword">if</span>(elem.length !== <span class="number">0</span>)&#123;</span><br><span class="line">    elem.forEach(<span class="function">(<span class="params">i,ind</span>)=&gt;</span>&#123;<span class="keyword">this</span>[ind]=i&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.length = elem.length</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;<span class="comment">//</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//让这样创造的对象能使用jQuery原型方法的关键</span></span><br><span class="line">init.prototype = jQuery.fn;</span><br></pre></td></tr></table></figure>

<h4 id="jQuery-的-extend-方法"><a href="#jQuery-的-extend-方法" class="headerlink" title="jQuery 的 extend 方法"></a>jQuery 的 extend 方法</h4><p>为jQuery添加方法, 分为jQuery.extend与jQuery.fn.extend,一个给本身一个给原型链, 原理是调用的时候 this 是不同的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jQuery.extend = jQuery.fn.extend = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (name <span class="keyword">in</span> <span class="built_in">arguments</span>[<span class="number">0</span>]) &#123;</span><br><span class="line">  <span class="keyword">this</span>[name] = <span class="built_in">arguments</span>[name]</span><br><span class="line">&#125;<span class="comment">//然后完善的话, 1.多个参数重载2.深复制3.防止bug如有环</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><figcaption><span>jQuery.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//some code</span></span><br><span class="line">length = <span class="built_in">arguments</span>.length,</span><br><span class="line">      deep = <span class="literal">false</span>;</span><br><span class="line">    <span class="built_in">console</span>.dir(<span class="keyword">this</span>) <span class="comment">//打印一下就知道了</span></span><br><span class="line">    <span class="comment">// Handle a deep copy situation</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> target === <span class="string">'boolean'</span>) &#123;</span><br><span class="line">      deep = target;</span><br><span class="line"><span class="comment">//some code</span></span><br></pre></td></tr></table></figure>

<p><img src="/image/jQuery-4.png" alt="一个是jQuery本身, 一个是它的原型对象"></p>
<h3 id="比较核心-想写-的方法"><a href="#比较核心-想写-的方法" class="headerlink" title="比较核心(想写)的方法"></a>比较核心(想写)的方法</h3><h4 id="dom-操作"><a href="#dom-操作" class="headerlink" title="dom 操作"></a>dom 操作</h4><p>这里用其他几个函数包装了一个私有函数, 通过传入的回调函数不同实现不同的功能, 姑且就叫回调包装吧, 函数 domManip 的主要功能就是添加 DOM 元素, 由添加的位置不同而提供了四个公开函数 append、prepend、before、after, 同时还可以执行脚本, 对字符串还会解析为节点, 如果是 script:src 会远程下载后执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">jQuery.fn.after = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> domManip(<span class="keyword">this</span>, aruguments, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.parentNode)&#123;</span><br><span class="line">      <span class="comment">//此处的 this 从后文可以看出是一个dom元素</span></span><br><span class="line">      <span class="keyword">this</span>.parentNode.insertBefore(e, <span class="keyword">this</span>.nextSibling);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//args 假定只有一种类型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">domManip</span>(<span class="params">collection, args, callback</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//这是个私有函数</span></span><br><span class="line">  <span class="keyword">var</span> args = concat.apply([], args),</span><br><span class="line">  length = collection.length</span><br><span class="line">  <span class="keyword">if</span>(length &gt; <span class="number">1</span>)&#123;</span><br><span class="line">    collection.forEach(<span class="function"><span class="params">i</span>=&gt;</span>&#123;</span><br><span class="line">      domManip(i, args, callback)</span><br><span class="line">    &#125;)<span class="comment">// 为了链式调用的返回</span></span><br><span class="line">    <span class="keyword">return</span> collection</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    callback.call(collection[<span class="number">0</span>], args);</span><br><span class="line">  &#125;<span class="comment">//后续1.参数判断2.脚本执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="attr-操作"><a href="#attr-操作" class="headerlink" title="attr 操作"></a>attr 操作</h4><p>很多有关属性的操作包括css()方法都是依靠这么一个私有函数 <code>access</code> 来实现的, 从注释上可以看出, 这是一个对集合元素进行get 或 set 操作的多功能方法, 当然主要功能还是传入的回调函数 fn 来实现</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">jQuery.fn.css = <span class="function"><span class="keyword">function</span>(<span class="params">name, value</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> access(</span><br><span class="line">  <span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params">elem, name, value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//后续写在插件部分里, 不然这里太长了</span></span><br><span class="line">    <span class="keyword">return</span> value !== <span class="literal">undefined</span> ?</span><br><span class="line">    jQuery.style(elem, name, value):</span><br><span class="line">    jQuery.css(elem, name);</span><br><span class="line">  &#125;, name, value);</span><br><span class="line">&#125;</span><br><span class="line">jQuery.fn.attr = <span class="function"><span class="keyword">function</span>(<span class="params">name, value</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//jQuery.attr 只是为了近似jQuery的写法(照抄过来的)</span></span><br><span class="line">  <span class="keyword">return</span> access(<span class="keyword">this</span>, jQuery.attr, name, value);</span><br><span class="line">&#125;</span><br><span class="line">jQuery.attr = <span class="function"><span class="keyword">function</span>(<span class="params">elem, name, value</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(value === <span class="literal">undefined</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> elem.getAttribute(name)</span><br><span class="line">  &#125;</span><br><span class="line">  elem.setAttribute(name, value + <span class="string">''</span>);</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">access</span>(<span class="params">elems, fn, key, value</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> len = elems.length</span><br><span class="line">  <span class="comment">// set</span></span><br><span class="line">  <span class="keyword">if</span>(value != <span class="literal">undefined</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span> (; i &lt; len; i++) &#123;</span><br><span class="line">        fn(elems[i], key, value);</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">return</span> elems</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// get</span></span><br><span class="line">  <span class="keyword">return</span> fn(elems[<span class="number">0</span>],key) <span class="comment">// jQuery 只会返回第一个的属性值</span></span><br><span class="line">&#125; <span class="comment">//后续1.参数重载(判断参数类型得到不同的执行过程)</span></span><br></pre></td></tr></table></figure>

<br>

<blockquote>
<p>基本上一个开源项目有不少内容都是后续向下兼容或者功能添加完善上去的, 可以学习一下代码结构和运行流程与原理, 至于模块组织, 现阶段我觉得都差不多, 不知道requirejs 淘汰的原因(也许也没淘汰?只是es6让他不再属于这个时代)</p>
</blockquote>
<br>
参考文章:

<p><a href="https://www.cnblogs.com/aaronjs/p/3279314.html" target="_blank" rel="noopener">jQuery源码分析系列</a></p>
<p><a href="https://github.com/JsAaron/jQuery" target="_blank" rel="noopener">前端JQuery系列</a></p>
<p><a href="https://www.cnblogs.com/snandy/p/5836155.html" target="_blank" rel="noopener">jQuery 3.0的domManip浅析</a></p>
</div>
          <hr>
        </div>
        <div class="recent-post-item article-container"><a class="article-title" href="/2019/09/29/prototype-new/">prototype new</a>
          <time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-09-29
          </time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/进阶/">进阶</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Javascript/">Javascript</a></span>
          <div class="content"><h3 id="new"><a href="#new" class="headerlink" title="new"></a>new</h3><p>首先来讲 new , 这个关键词主要就是用在创建类或函数的实例上的。当然, 类其实是构造函数的语法糖, 让语言的表达更直观。</p>
<p>new 的操作流程如下:</p>
<blockquote>
<ol>
<li>创建空的 JavaScript 对象, Object.create(null)</li>
<li>指定构造函数, 绑定原型链, obj.__proto__ = Func.prototype</li>
<li>绑定obj为this后运行 Func.call(obj,arguments) 获得返回值</li>
<li>判断返回值是否为对象, 否定的话返回构造的对象, 肯定的话返回既定返回值</li>
</ol>
</blockquote>
<p><a href="https://github.com/mqyqingfeng/Blog/issues/13" target="_blank" rel="noopener">具体可以看</a></p></div><a class="more" href="/2019/09/29/prototype-new/#more">阅读更多</a>
          <hr>
        </div>
        <div class="recent-post-item article-container"><a class="article-title" href="/2019/09/16/this-apply-call/">this,apply,call</a>
          <time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-09-16
          </time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/js/">Javascript</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/junior/">进阶</a></span>
          <div class="content"><h2 id="什么是-this"><a href="#什么是-this" class="headerlink" title="什么是 this"></a>什么是 this</h2><p>this 首先是一个对象(在严格模式下也会是 undefined),当然在 <em>MDN</em> 中也被形容为当前执行代码的环境对象。这么称呼的原因和函数的调用有关系,例如:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(name)</span><br><span class="line">&#125;</span><br><span class="line">test(<span class="string">'123'</span>)</span><br><span class="line">test.call(<span class="literal">undefined</span>,<span class="string">'123'</span>)</span><br></pre></td></tr></table></figure></div><a class="more" href="/2019/09/16/this-apply-call/#more">阅读更多</a>
          <hr>
        </div>
        <div class="recent-post-item article-container"><a class="article-title" href="/2019/09/10/hello-world/">Hello World</a>
          <time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-09-10
          </time>
          <div class="content"><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>
</div>
          <hr>
        </div>
        <nav id="pagination">
          <div class="pagination"><span class="page-number current">1</span>
          </div>
        </nav>
      </div>
    </div>
    <footer class="footer-bg" style="background-image: url(http://img.luckyray.cn/896653.jpg)">
      <div class="layout" id="footer">
        <div class="copyright">&copy;2019 By null</div>
        <div class="framework-info"><span>驱动 - </span><a href="#"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="#"><span>diary</span></a></div>
      </div>
    </footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i>
    <script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script>
    <script src="/js/utils.js?version=1.6.1"></script>
    <script src="/js/fancybox.js?version=1.6.1"></script>
    <script src="/js/sidebar.js?version=1.6.1"></script>
    <script src="/js/copy.js?version=1.6.1"></script>
    <script src="/js/fireworks.js?version=1.6.1"></script>
    <script src="/js/transition.js?version=1.6.1"></script>
    <script src="/js/scroll.js?version=1.6.1"></script>
    <script src="/js/head.js?version=1.6.1"></script>
    <script>
      if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
        $('#nav').addClass('is-mobile')
        $('footer').addClass('is-mobile')
      }
    </script>
  </body>
</html>